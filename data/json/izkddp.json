{
  "body_html": "<h2 id=\"C9vJi\">SSE 误差平方和 (手肘法)</h2><p><br /></p><p>手肘法的核心指标是 SSE(sum of the squared errors，误差平方和)</p><p><span class=\"lake-fontsize-12\" style=\"color: #4F4F4F;\"><br /></span></p><p style=\"text-align: left;\"><img src=\"https://cdn.nlark.com/yuque/__latex/4064c57a49a5f00aff4fce07c2a0a2c7.svg#card=math&amp;code=S%20S%20E%3D%5Csum_%7Bi%3D1%7D%5E%7Bk%7D%20%5Csum_%7Bp%20%5Cin%20C_%7Bi%7D%7D%5Cleft%7Cp-m_%7Bi%7D%5Cright%7C%5E%7B2%7D&amp;height=56&amp;width=183\" style=\"max-width: 600px; width: 183px;\" /></p><p style=\"text-align: left;\"><br /></p><p style=\"text-align: left;\">其中，C<sub>i </sub>是第 i 个簇，p 是 <span>C</span><sub>i </sub>中的样本点，m<span>i </span>是 <span>C</span><sub>i </sub>的质心（C<span>i</span>中所有样本的均值），SSE 是所有样本的聚类误差，代表了聚类效果的好坏。</p><p><br /></p><p>手肘法的核心思想是：随着聚类数 k 的增大，样本划分会更加精细，每个簇的聚合程度会逐渐提高，那么误差平方和 SSE 自然会逐渐变小。并且，当 k 小于真实聚类数时，由于 k 的增大会大幅增加每个簇的聚合程度，故 SSE 的下降幅度会很大，而当 k 到达真实聚类数时，再增加 k 所得到的聚合程度回报会迅速变小，所以 SSE 的下降幅度会骤减，然后随着 k 值的继续增大而趋于平缓，也就是说 SSE 和 k 的关系图是一个手肘的形状，而这个肘部对应的 k 值就是数据的真实聚类数。当然，这也是该方法被称为手肘法的原因。</p><p><br /></p><p><img alt=\"image.png\" title=\"image.png\" src=\"https://cdn.nlark.com/yuque/0/2019/png/85998/1558604907193-3650faeb-8014-40f4-bbd6-1caa7ae76306.png#align=left&amp;display=inline&amp;height=244&amp;name=image.png&amp;originHeight=488&amp;originWidth=959&amp;size=137189&amp;status=done&amp;width=479.5\" style=\"max-width: 600px; width: 479.5px;\" /></p><p><br /></p><p><br /></p><p><strong>做法：</strong></p><ul><li>让 k 从 1 开始取值，知道合适的上限（这个上限需要人为确定，比如 8）。</li><li>对每一个 k 进行聚类，生成对应的 SSE，画出关系图。</li><li>选取最佳 k。</li></ul><p><br /></p><pre data-lang=\"python\"><code>\nimport pandas as pd\nfrom sklearn.cluster import KMeans\nimport matplotlib.pyplot as plt\n \ndf_features = pd.read_csv(r'C:\\预处理后数据.csv',encoding='gbk') # 读入数据\n'利用SSE选择k'\nSSE = []  # 存放每次结果的误差平方和\nfor k in range(1,9):\n    estimator = KMeans(n_clusters=k)  # 构造聚类器\n    estimator.fit(df_features[['R','F','M']])\n    SSE.append(estimator.inertia_)\nX = range(1,9)\nplt.xlabel('k')\nplt.ylabel('SSE')\nplt.plot(X,SSE,'o-')</code></pre><p><br /></p><p><img alt=\"image.png\" title=\"image.png\" src=\"https://cdn.nlark.com/yuque/0/2019/png/85998/1558606506999-67c8191c-c63a-4c02-abfd-130f046bc732.png#align=left&amp;display=inline&amp;height=300&amp;name=image.png&amp;originHeight=600&amp;originWidth=800&amp;size=31614&amp;status=done&amp;width=400\" style=\"max-width: 600px; width: 400px;\" /></p><p><br /></p><p>显然，肘部对于的k值为4，故对于这个数据集的聚类而言，最佳聚类数应该选4。</p><p><br /></p><p><br /></p><p><br /></p><p>参考文献：</p><p><a href=\"https://blog.csdn.net/qq_15738501/article/details/79036255\" target=\"_blank\">https://blog.csdn.net/qq_15738501/article/details/79036255</a></p>",
  "slug": 1763562,
  "title": "K-means：如何确定 K"
}