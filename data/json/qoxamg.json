{
  "body_html": "<p><br /></p><h3 id=\"2XmrG\"><a href=\"#0.简介\"></a>0.简介</h3><p>提到空间数据库，首先想到的一定是Esri公司的<span style=\"color: #389E0D;\">ArcSDE</span>（SDE即Spatial Database Engine，空间数据库引擎），ArcSDE主要支持的数据库包括Oracle，SQL Server，IBM DB2。功能好，性能好，但是价格也好。</p><p><br /></p><p>国内很多大型活互联网公司已经转向MySql阵营。对于有实力的大公司，使用开源的MySql，可以针对自己的业务对MySql源码进行修改及优化。对于业务量不大的初创公司，直接使用开源MySql，PostgreSQL等数据库，也可节约成本，未来数据库扩展也有很多可参考的资料。</p><p><br /></p><p>PostgreSQL由于具备PostGIS扩展而在开源GIS中有广泛地应用，可视化工具包括pgAdmin、Quantum GIS（类似ArcGIS Desktop）</p><p><br /></p><p>从MySQL4.1开始，也对空间数据库进行了支持，以下是简单的说明和测试：</p><p><br /></p><h3 id=\"AWOPE\"><a href=\"#1.常用使用场景\"></a>1.常用使用场景</h3><p><strong>矩形查询：</strong></p><p>适合智能手机、网页端高效展示屏幕范围内数据。通过API获取显示屏4角的坐标点，顺序连接生成矩形，空间数据库提供查询矩形范围内坐标功能。</p><p><strong>圆型查询：</strong></p><p>根据当前所在位置为中心点，根据给定的里程数为半径生成圆形，搜索圆形范围内的数据。</p><p><br /></p><h3 id=\"XyPby\"><a href=\"#2.mysql支持的类型\"></a>2.MySql支持的类型</h3><p>点 <code>POINT(15 20)</code></p><p>线 <code>LINESTRING(0 0, 10 10, 20 25, 50 60)</code></p><p>面 <code>POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))</code></p><p>多个点 <code>MULTIPOINT(0 0, 20 20, 60 60)</code></p><p>多个线 <code>MULTILINESTRING((10 10, 20 20), (15 15, 30 15))</code></p><p>多个面 <code>MULTIPOLYGON(((0 0,10 0,10 10,0 10,0 0)),((5 5,7 5,7 7,5 7, 5 5)))</code></p><p>集合 <code>GEOMETRYCOLLECTION(POINT(10 10), POINT(30 30), LINESTRING(15 15, 20 20))</code>，简称GEOMETRY，可以放入点、线、面。</p><p><br /></p><h3 id=\"pzkb2\"><a href=\"#3.测试\"></a>3.测试</h3><h4 id=\"uNbQm\"><a href=\"#a.以存储坐标点为例\"></a>a.以存储坐标点为例</h4><pre data-lang=\"sql\"><code>DROP TABLE IF EXISTS points;\n\nCREATE TABLE points (\nid int(11) unsigned NOT NULL AUTO_INCREMENT,\nname varchar(20) NOT NULL DEFAULT '',\nlocation point NOT NULL,\nPRIMARY KEY (id),\nSPATIAL KEY sp_index (location)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n#unsigned    将数字类型无符号化，代表该字段没有正负\n#DEFAULT ''    用于向列中插入默认值，引号内填写默认值\n#spatial    空间索引\n#AUTO_INCREMENT    可以理解为自动递增的意思，每增加一条记录，值会自动加1。</code></pre><p><br /></p><h4 id=\"YAjPF\"><a href=\"#b.插入测试数据\"></a>b.插入测试数据</h4><pre data-lang=\"sql\"><code># 天安门\nINSERT INTO points VALUES (1,'aaaa',POINT(116.397389,39.908149));\n# 颐和园\nINSERT INTO points VALUES (2,'bbbb',POINT(116.273106,39.992634));</code></pre><p><br /></p><h4 id=\"q44Iq\"><a href=\"#c.多边形查询\"></a>c.多边形查询</h4><p>多边形查询 起始点与终点为同一点 以灵境胡同、灯市口、崇文门、宣武门组成多边形</p><pre data-lang=\"sql\"><code>#定义多边形\nSET @rect = CONCAT('POLYGON((116.373871 39.915786,116.417645 39.916444,116.41816 39.900841,116.374214 39.900182,116.373871 39.915786))');\n\n#使用变量\nselect name,X(location),Y(location),Astext(location) from points\nwhere INTERSECTS( location, GEOMFROMTEXT(@rect) ) ;\n\n\n#CONCAT（）    函数用于将多个字符串连接成一个字符串</code></pre><p><br /></p>",
  "slug": 583024,
  "title": "MySQL 空间数据"
}