{
  "body_html": "<p><span style=\"color: #50545C;\"><span style=\"background-color: #FFFFFF;\">Google Apps Script 使用的是 JavaScript 语言;</span></span></p><p><br /></p><p>在 Script 里使用 <a href=\"https://developers.google.com/apps-script/reference/jdbc/jdbc#getcloudsqlconnectionurl\" target=\"_blank\">Jdbc.getCloudSqlConnection</a> 或 <a href=\"https://developers.google.com/apps-script/reference/jdbc/jdbc#getconnectionurl\" target=\"_blank\">Jdbc.getConnection</a> 来连接外部数据库，</p><p>参见 Google 提供的帮助：<a href=\"https://developers.google.com/apps-script/guides/jdbc\" target=\"_blank\">External Databases via JDBC</a> ；</p><p><br /></p><p>实例参考了 <a href=\"https://gist.github.com/pradeepbheron/e6129c9fd9bc74e814d0\" target=\"_blank\">Git</a> 上的语句；</p><p><br /></p><p><br /></p><h5 id=\"t6k2zk\"><a href=\"#t6k2zk\"></a>连接数据库</h5><pre data-lang=\"javascript\"><code>function myMySQLFetchData() { \n  var conn = Jdbc.getConnection('jdbc:mysql://127.0.0.1:3306/employee_db', 'username', 'pass');\n  var start = new Date(); // Get script starting time\n  var stmt = conn.createStatement();\n  stmt.setMaxRows(1000);// It sets the limit of the maximum nuber of rows in a ResultSet object\n\n\n  var results = stmt.executeQuery('SELECT id,emp_name, emp_code FROM employee_details GROUP BY 1 LIMIT 1000');  \n\n  //change table name as per your database structure\n\n  var doc = SpreadsheetApp.getActiveSpreadsheet('sheet1'); // 返回当前活动的电子表格\n  var cell = doc.getRange('a1');\n  var row = 0;\n  var getCount = results.getMetaData().getColumnCount(); // Mysql table column name count.\n\n  for (var i = 0; i &lt; getCount; i++){  \n     cell.offset(row, i).setValue(rs.getMetaData().getColumnName(i+1)); // Mysql table column name will be fetch and added in spreadsheet.\n  }  \n\n\n\n  var row = 1; \n  while (rs.next()) {\n    for (var col = 0; col &lt; rs.getMetaData().getColumnCount(); col++) { \n      cell.offset(row, col).setValue(rs.getString(col + 1)); // Mysql table column data will be fetch and added in spreadsheet.\n    }\n    row++;\n  }\n  \n  rs.close();\n  stmt.close();\n  conn.close();\n  var end = new Date(); // Get script ending time\n  Logger.log('Time elapsed: ' + (end.getTime() - start.getTime())); // To generate script log. To view log click on View -&gt; Logs.\n}</code></pre><p><br /></p>",
  "slug": 775689,
  "title": "Google App Script"
}