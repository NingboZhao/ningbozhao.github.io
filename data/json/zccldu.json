{
  "body_html": "<p>用到的包</p><ul><li><p>使用<code>xlrd</code>扩展包读取excel数据</p></li></ul><ul><li><p>使用<code>matplotlib</code>绘制二维图像</p></li></ul><ul><li><p>美化图像，添加标注，注释，显示Latex风格公式，坐标点处透明化处理等技巧</p></li></ul><p><br /></p><h3 id=\"matplotlib\"><a href=\"#matplotlib\"></a>matplotlib</h3><p>安装完成matplotlib后，运行一个小程序测试其是否正常。我们来绘制一个非常简单的正弦函数。</p><pre data-lang=\"python\"><code>import numpy as np\nimport matplotlib.pyplot as plt\n\n\nx = np.linspace(0, 10, 500)\ndashes = [10, 5, 100, 5]  # 10 points on, 5 off, 100 on, 5 off\n\nfig, ax = plt.subplots()\nline1, = ax.plot(x, np.sin(x), '--', linewidth=2,\n                 label='Dashes set retroactively')\nline1.set_dashes(dashes)\n\nline2, = ax.plot(x, -1 * np.sin(x), dashes=[30, 5, 10, 5],\n                 label='Dashes set proactively')\n\nax.legend(loc='lower right')\nplt.show()</code></pre><p><br /></p><p>如果一切正常，应该得到如下显示的图片：</p><p><img src=\"https://lark-assets-prod.oss-cn-hangzhou.aliyuncs.com/2018/png/98b5c2d6-b9d6-43c5-9285-772c3b0c5fbc.png#align=left&amp;display=inline&amp;height=480&amp;originHeight=480&amp;originWidth=640&amp;status=done&amp;width=467\" style=\"max-width: 600px; width: 467px;\" /></p><p><br /></p><h3 id=\"xlrd\"><a href=\"#xlrd\"></a>xlrd</h3><p>xlrd顾名思义，就是excel文件的后缀名.xl文件read的扩展包。这个包<mark>只能读取文件，不能写入</mark>。写入需要使用另外一个包。但是这个包，其实也能读取.xlsx文件。</p><p>从excel中读取数据的过程比较简单，首先从xlrd包导入<code>open_workbook</code>，然后打开excel文件，把每个sheet里的每一行每一列数据都读取出来即可。很明显，这是个循环过程。</p><p><br /></p><pre data-lang=\"python\"><code>from xlrd import open_workbook\nx_data1=[]\ny_data1=[]\nwb = open_workbook('/Users/zhaoningbo/Desktop/google.xlsx')\nfor s in wb.sheets():\n    print('Sheet:',s.name)\n    for row in range(s.nrows):\n        print('the row is:',row)\n        values = []\n        for col in range(s.ncols):\n            values.append(s.cell(row,col).value)\n        print(values)\n        x_data1.append(values[0])\n        y_data1.append(values[1])</code></pre><p><br /></p><p>解释一下这段代码：</p><p>打开一个excel文件后，首先对文件内的sheet进行循环，这是最外层循环；</p><p>在每个sheet内，进行第二次循环，行循环；</p><p>在每行内，进行列循环，这是第三层循环。</p><p>在最内层列循环内，取出行列值，复制到新建的values列表内，很明显，源数据有几列，values列表就有几个元素。</p><p>我们例子中的excel文件有两列，分别对应“角度”和DC值。所以在列循环结束后，我们将取得的数据保存到x_data1和y_data1这两个列表中。</p>",
  "slug": 582272,
  "title": "python 绘制图像"
}