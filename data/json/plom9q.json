{
  "body_html": "<p><code>Employee</code><span> 表包含所有员工信息，每个员工有其对应的 Id, salary 和 department Id 。</span><span><br /></span></p><p><span><img alt=\"image.png\" title=\"image.png\" src=\"https://cdn.nlark.com/yuque/0/2019/png/85998/1549958739259-7c37a11a-e690-4b09-a9c4-ee495137e73f.png#align=left&amp;display=inline&amp;height=201&amp;name=image.png&amp;originHeight=402&amp;originWidth=630&amp;size=44820&amp;width=315\" style=\"max-width: 600px; width: 315px;\" /></span></p><p><br /></p><p><code>Department</code><span> 表包含公司所有部门的信息。</span><span><br /></span></p><p><span><img alt=\"image.png\" title=\"image.png\" src=\"https://cdn.nlark.com/yuque/0/2019/png/85998/1549958766433-210cc648-159a-41eb-9cfb-69d90eee7f7c.png#align=left&amp;display=inline&amp;height=122&amp;name=image.png&amp;originHeight=244&amp;originWidth=318&amp;size=10086&amp;width=159\" style=\"max-width: 600px; width: 159px;\" /></span></p><p><br /></p><p><span>编写一个 SQL 查询，找出每个部门工资前三高的员工。例如，根据上述给定的表格，查询结果应返回：</span><span><br /></span></p><p><span><img alt=\"image.png\" title=\"image.png\" src=\"https://cdn.nlark.com/yuque/0/2019/png/85998/1549958792345-a0aca9a8-a0e4-4b60-8de6-100a611f8639.png#align=left&amp;display=inline&amp;height=183&amp;name=image.png&amp;originHeight=366&amp;originWidth=570&amp;size=41438&amp;width=285\" style=\"max-width: 600px; width: 285px;\" /></span></p><p><br /></p><p><br /></p><p>解答:</p><p><br /></p><pre data-lang=\"sql\"><code>SELECT\n\tDepartment,\n\tEmployee,\n\tSalary \nFROM\n\t(\n\tSELECT Department,Employee,Salary,\n\t\t@rowNum :=IF(@LastD = t.Department,@rowNum + ( @lastS &lt;&gt; t.Salary ),1 ) AS seq,\n\t\t@lastD := t.Department,\n\t\t@lastS := t.Salary \n\tFROM\n\t\t(SELECT d.NAME Department,e.NAME Employee,Salary \n\t\t FROM Employee e,Department d \n\t\t WHERE e.DepartmentId = d.Id \n\t\t ORDER BY d.NAME,Salary DESC ) t,\n\t\t(SELECT @lastD:= -1,@lastS:= -1,@rowNum:= 0 ) AS init \n\t) AS t2 \nWHERE t2.seq &lt;= 3;</code></pre><p><br /></p>",
  "slug": 1239262,
  "title": "185. 部门工资前三高的员工"
}